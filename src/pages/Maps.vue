<template>

<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <Map :routes="routes"></Map>
            </div>            
        </div>
    </div>
</div>

</template>

<script setup lang="ts">
import { ref, onMounted } from 'vue';
import Map from '@components/Map.vue';

const presetData: [number, number][] = [
  [3.2690515637244513, 101.65283525496457],
  [3.271960009172302, 101.65429184988885],
  [3.275110815549323, 101.65186419168171],
  [3.2705057875029464, 101.65101451130921],
  [3.2637193918402643, 101.64907238474346],
  [3.261538040638139, 101.64846547019168],
  [3.257417697679825, 101.64640196071562],
  [3.253539712431005, 101.6450667487017],
  [3.251358339170422, 101.64494536579134],
  [3.2499040877087984, 101.64967929929527],
  [3.2467532023530588, 101.65526291317171],
  [3.2443294376978287, 101.65854025175138],
  [3.242875176114662, 101.66533769473138],
  [3.2421480445387543, 101.66558046055209],
  [3.2376640549408147, 101.66958609659389],
  [3.2376640549408147, 101.66982886241462],
  [3.2356038368466398, 101.67104269151818],
  [3.228211255112052, 101.67140684024925],
  [3.2272417322029576, 101.67177098898031],
  [3.220939810758274, 101.6712854573389],
  [3.216698110895001, 101.67189237189069],
  [3.211244470856108, 101.67201375480104],
  [3.209426584368603, 101.67164960606996],
  [3.2074875018837976, 101.6715282231596],
  [3.20409334408152, 101.67074097383426],
  [3.1950094733232417, 101.66833771482129],
  [3.1854113338573695, 101.67005432840196],
  [3.182154801908607, 101.67211426469878],
  [3.185068541505548, 101.66953934432777],
  [3.179583848363852, 101.67228592605684],
  [3.174613320010074, 101.68224228482478],
  [3.169480391034617, 101.68978612097328],
  [3.1729454725201975, 101.69407308004936],
  [3.1737607841231257, 101.699176602759],
  [3.1733531284020535, 101.70734223909442],
  [3.166626784416625, 101.71387475180099],
  [3.159288906305166, 101.72040726086931],
  [3.1505241505898685, 101.7232652335867],
  [3.1448168281115243, 101.72142796541124],
  [3.1409439843513023, 101.72061140177769],
  [3.1354404448270903, 101.72224452904476]
];

const routes = ref<[number, number][]>([]);

const addNewLocation = (lat: number, lng: number) => {
  routes.value.push([lat, lng]);
};

// Simulate adding new locations in real-time (every 2 seconds)
setInterval(() => {
    if (routes.value.length > 0) {
        const lastLocation = routes.value[routes.value.length - 1];
        const newLat = lastLocation[0] + 0.001; // Example increment
        const newLng = lastLocation[1] + 0.001; // Example increment
        addNewLocation(newLat, newLng);
    }  
}, 2000);

onMounted(() => {
    presetData.forEach((location, index) => {
        setTimeout(() => {
            addNewLocation(location[0], location[1]);
        }, 1000);
    });
});
</script>